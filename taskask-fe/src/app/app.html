<div class="page">
  <!-- Retro Gradient Banner -->
  <div class="retro-banner"></div>
  <div class="retro-banner-2"></div>

  <div class="shell">
    <!-- Header with pulsing logo -->
    <header class="header">
      <div class="brand">
        <div class="crest">T</div>
        <div>
          <h1>{{ title }}</h1>
          <p class="tagline">{{ tagline }}</p>
        </div>
      </div>

      <nav class="navbar" *ngIf="state.isLoggedIn(); else guest">
        <!-- User info -->
        <div class="nav-user">
          <span class="badge soft">{{ state.userEmail() }}</span>
          <span class="badge role">{{ state.userRole() || 'USER' }}</span>
        </div>
        
        <!-- Navigation links + actions -->
        <div class="nav-actions">
          <a routerLink="/manager" *ngIf="state.userRole() === 'MANAGER'" class="nav-link">‚öô MANAGER</a>
          <a routerLink="/team-lead" *ngIf="state.userRole() === 'TEAM_LEAD'" class="nav-link">üë• TEAM LEAD</a>
          <a routerLink="/employee" *ngIf="state.userRole() === 'EMPLOYEE'" class="nav-link">üìù EMPLOYEE</a>
          <a routerLink="/admin" *ngIf="state.userRole() === 'ADMIN'" class="nav-link">üîê ADMIN</a>
          
          <!-- Notification Bell -->
          <div class="notification-wrapper">
            <button class="notification-bell" (click)="state.toggleNotificationPanel()">
              üîî
              <span class="notification-badge" *ngIf="state.unreadCount() > 0">
                {{ state.unreadCount() > 9 ? '9+' : state.unreadCount() }}
              </span>
            </button>
            
            <!-- Notification dropdown panel -->
            <div class="notification-panel" *ngIf="state.showNotificationPanel()">
              <div class="notification-header">
                <span>üîî NOTIFICATIONS</span>
                <button class="close-btn" (click)="state.closeNotificationPanel()">‚úï</button>
              </div>
              
              <div class="notification-empty" *ngIf="state.notifications().length === 0">
                [ NO NOTIFICATIONS ]
              </div>
              
              <div class="notification-list" *ngIf="state.notifications().length > 0">
                <div 
                  class="notification-item" 
                  *ngFor="let n of state.notifications()"
                  [class.unread]="!n.read"
                >
                  <span class="notification-icon">
                    {{ n.type === 'TASK_ASSIGNED' ? 'üìã' : '‚úÖ' }}
                  </span>
                  <div class="notification-content">
                    <p class="notification-message">{{ n.message }}</p>
                    <span class="notification-time">{{ n.createdAt | date:'short' }}</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <button class="btn danger" (click)="logout()">[ LOGOUT ]</button>
        </div>
      </nav>
      
      <ng-template #guest>
        <div class="nav-actions">
          <a class="btn primary" routerLink="/auth">‚òÖ LOGIN / SIGN UP ‚òÖ</a>
        </div>
      </ng-template>
    </header>

    <!-- Marquee -->
    <div class="marquee-wrap">
      <div class="marquee-text">
        ‚òÖ WELCOME TO TASKASK ‚òÖ GET THINGS DONE ‚òÖ MANAGE YOUR TEAM ‚òÖ RETRO STYLE ‚òÖ 
        ‚òÖ WELCOME TO TASKASK ‚òÖ GET THINGS DONE ‚òÖ MANAGE YOUR TEAM ‚òÖ RETRO STYLE ‚òÖ 
      </div>
    </div>

    <main>
      <router-outlet></router-outlet>
    </main>

    <footer style="margin-top: 40px; text-align:center; font-family: 'Press Start 2P', monospace; font-size: 10px; color: var(--yellow);">
      ‚òÖ ¬© {{ currentYear }} TASKASK ‚òÖ RETRO EDITION ‚òÖ
    </footer>
  </div>
</div>
