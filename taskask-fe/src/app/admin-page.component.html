<div class="space-y-4">
  <!-- Header -->
  <div class="panel" style="background: linear-gradient(135deg, var(--magenta), var(--cyan)); border-color: var(--yellow);">
    <div class="flex items-center justify-between gap-3 flex-wrap">
      <div class="flex items-center gap-3">
        <div class="crest" style="width: 48px; height: 48px; font-size: 16px;">A</div>
        <div>
          <h2 style="color: var(--bg); text-shadow: 2px 2px 0 var(--yellow);">
            üîê ADMIN DASHBOARD
          </h2>
          <p style="color: var(--bg); font-size: 12px;">PERFORMANCE + TASKS + USERS</p>
        </div>
      </div>

      <button
        class="btn"
        style="background: var(--yellow); color: var(--bg); border-color: var(--bg);"
        (click)="state.loadPerformance(); state.loadAllTasks(); state.loadAllUsers(); state.loadAllTeams()"
      >
        ‚Üª REFRESH ALL
      </button>
    </div>
  </div>

  <!-- Main Grid: Tasks (left 2/3) | Sidebar (right 1/3) -->
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
    <!-- All Tasks (Left - 2 columns) -->
    <div class="lg:col-span-2 panel">
      <div class="panel-header">
        <div>
          <h3>üìã ALL TASKS</h3>
          <p class="muted" style="font-size: 12px;">ADMIN OVERVIEW</p>
        </div>

        <button class="btn" (click)="state.loadAllTasks()">
          ‚Üª REFRESH
        </button>
      </div>

      <div *ngIf="!tasks.length" class="empty">
        <p style="font-size: 32px; margin-bottom: 8px;">üìã</p>
        <p>[ NO TASKS YET ]</p>
        <p style="font-size: 12px; margin-top: 4px;">CREATE ONE OR REFRESH!</p>
      </div>

      <div class="task-grid" *ngIf="tasks.length">
        <div *ngFor="let task of tasks" class="task-card">
          <div class="task-head">
            <div style="min-width: 0;">
              <h3 style="word-break: break-word; margin-bottom: 4px;">{{ task.title }}</h3>
              <p style="font-size: 14px; word-break: break-word;">{{ task.description || '[ NO DESCRIPTION ]' }}</p>
            </div>

            <div style="display: flex; flex-direction: column; align-items: flex-end; gap: 4px;">
              <span
                class="badge"
                [ngClass]="{
                  'bg-red': task.priority==='HIGH',
                  'bg-yellow': task.priority==='MEDIUM',
                  'bg-cyan': task.priority==='LOW'
                }"
                [style.background]="task.priority==='HIGH' ? 'var(--red)' : task.priority==='MEDIUM' ? 'var(--yellow)' : 'var(--cyan)'"
                [style.color]="'var(--bg)'"
                [style.border-color]="'var(--bg)'"
              >
                {{ task.priority }}
              </span>
              <span style="font-size: 12px; color: var(--yellow);">DUE: {{ task.dueDate || 'NONE' }}</span>
            </div>
          </div>

          <div style="display: flex; align-items: center; gap: 8px;">
            <span
              class="badge"
              [style.background]="task.status==='COMPLETED' ? 'var(--lime)' : task.status==='PENDING' ? 'var(--orange)' : 'var(--cyan)'"
              [style.color]="'var(--bg)'"
              [style.border-color]="'var(--bg)'"
            >
              {{ task.status }}
            </span>
          </div>

          <div style="font-size: 12px; background: var(--bg); border: 2px solid var(--cyan); padding: 8px;">
            <p style="word-break: break-word;">‚Üí CREATED BY: {{ task.createdByName || 'UNKNOWN' }}</p>
            <p style="word-break: break-word;">‚Üí ASSIGNED TO: {{ task.assignedToName || 'UNKNOWN' }}</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Right Sidebar (1 column) - Performance, Teams, Users stacked -->
    <div class="lg:col-span-1 space-y-4">
      <!-- Performance -->
      <div class="panel" style="background: linear-gradient(135deg, var(--panel), rgba(0,255,255,0.1));">
        <div class="panel-header">
          <div>
            <h3>üìä PERFORMANCE</h3>
            <p class="muted" style="font-size: 12px;">TEAM-WIDE METRICS</p>
          </div>
          <button class="btn" style="padding: 8px;" (click)="state.loadPerformance()">‚Üª</button>
        </div>

        <div *ngIf="!perf" class="empty">
          <p style="font-size: 24px; margin-bottom: 8px;">üìà</p>
          <p style="font-size: 12px;">[ NO DATA YET ]</p>
        </div>

        <div *ngIf="perf as p" style="display: grid; gap: 12px;">
          <!-- KPI cards -->
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
            <div style="padding: 12px; border: 3px solid var(--yellow); background: rgba(255,255,0,0.1);">
              <p style="font-size: 10px; color: var(--yellow);">TOTAL</p>
              <p style="font-size: 24px; color: var(--yellow);">{{ p.totalTasks }}</p>
            </div>

            <div style="padding: 12px; border: 3px solid var(--lime); background: rgba(0,255,0,0.1);">
              <p style="font-size: 10px; color: var(--lime);">DONE</p>
              <p style="font-size: 24px; color: var(--lime);">{{ p.completedTasks }}</p>
            </div>

            <div style="padding: 12px; border: 3px solid var(--cyan); background: rgba(0,255,255,0.1);">
              <p style="font-size: 10px; color: var(--cyan);">IN PROG</p>
              <p style="font-size: 24px; color: var(--cyan);">{{ p.inProgressTasks }}</p>
            </div>

            <div style="padding: 12px; border: 3px solid var(--orange); background: rgba(255,102,0,0.1);">
              <p style="font-size: 10px; color: var(--orange);">PENDING</p>
              <p style="font-size: 24px; color: var(--orange);">{{ p.pendingTasks }}</p>
            </div>
          </div>

          <div style="font-size: 12px; color: var(--lime); background: rgba(0,255,0,0.1); border: 2px solid var(--lime); padding: 8px;">
            ‚úì COMPLETION: {{ p.completionRatePercent | number:'1.0-1' }}%
          </div>
        </div>
      </div>

      <!-- Teams -->
      <div class="panel" style="background: linear-gradient(135deg, var(--panel), rgba(255,0,255,0.1));">
        <div class="panel-header">
          <div>
            <h3>üë• TEAMS</h3>
            <p class="muted" style="font-size: 12px;">ALL TEAMS</p>
          </div>
          <button class="btn" style="padding: 8px;" (click)="state.loadAllTeams()">‚Üª</button>
        </div>

        <div *ngIf="!teams.length" class="empty">
          <p style="font-size: 24px; margin-bottom: 8px;">üë•</p>
          <p style="font-size: 12px;">[ NO TEAMS YET ]</p>
        </div>

        <div *ngIf="teams.length" style="display: grid; gap: 8px;">
          <div
            *ngFor="let team of teams"
            style="background: var(--bg); border: 2px solid var(--magenta); padding: 8px;"
          >
            <p style="font-size: 14px; word-break: break-word;">{{ team.name }}</p>
            <p style="font-size: 12px; color: var(--magenta);">üëë {{ team.leadName }}</p>
          </div>
        </div>
      </div>

      <!-- Users -->
      <div class="panel" style="background: linear-gradient(135deg, var(--panel), rgba(0,255,0,0.1));">
        <div class="panel-header">
          <div>
            <h3>üë§ USERS</h3>
            <p class="muted" style="font-size: 12px;">ROLES OVERVIEW</p>
          </div>
          <button class="btn" style="padding: 8px;" (click)="state.loadAllUsers()">‚Üª</button>
        </div>

        <div *ngIf="!users.length" class="empty">
          <p style="font-size: 24px; margin-bottom: 8px;">üë§</p>
          <p style="font-size: 12px;">[ NO USERS YET ]</p>
        </div>

        <div *ngIf="users.length" style="display: grid; gap: 8px; max-height: 256px; overflow-y: auto;">
          <div
            *ngFor="let u of users"
            style="background: var(--bg); border: 2px solid var(--lime); padding: 8px; display: flex; align-items: center; justify-content: space-between; gap: 8px;"
          >
            <div style="min-width: 0;">
              <p style="font-size: 14px; word-break: break-word;">{{ u.fullName }}</p>
              <p style="font-size: 12px; color: var(--ink-soft); word-break: break-word;">{{ u.email }}</p>
            </div>

            <span
              class="badge"
              [style.background]="u.role==='ADMIN' ? 'var(--red)' : u.role==='MANAGER' ? 'var(--yellow)' : u.role==='TEAM_LEAD' ? 'var(--magenta)' : 'var(--cyan)'"
              [style.color]="'var(--bg)'"
              [style.border-color]="'var(--bg)'"
              style="flex-shrink: 0;"
            >
              {{ u.role }}
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
