<div class="space-y-4">
  <!-- Header -->
  <div class="panel" style="background: linear-gradient(135deg, var(--cyan), var(--magenta)); border-color: var(--yellow);">
    <div class="flex justify-between items-center gap-3 flex-wrap">
      <div class="flex items-center gap-3">
        <div class="crest" style="width: 40px; height: 40px; font-size: 12px; background: var(--yellow); color: var(--bg); border-color: var(--bg);">TL</div>
        <h2 style="color: var(--bg); text-shadow: 2px 2px 0 var(--yellow);">
          TEAM LEAD
        </h2>
      </div>

      <button
        class="btn"
        style="background: var(--yellow); color: var(--bg); border-color: var(--bg);"
        (click)="state.loadManagerTasks()"
      >
        ‚Üª REFRESH
      </button>
    </div>
  </div>

  <!-- Panels Grid -->
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
    <!-- Team Panel -->
    <div class="panel">
      <div class="panel-header">
        <div>
          <h2>üë• TEAM</h2>
          <p class="muted" style="font-size: 12px;">CREATE + MANAGE MEMBERS</p>
        </div>
        <div class="crest" style="width: 48px; height: 48px; font-size: 16px; background: var(--lime); color: var(--bg); border-color: var(--bg);">‚úì</div>
      </div>

      <!-- Show existing team name -->
      <div *ngIf="state.team()" style="margin-bottom: 16px; padding: 12px; background: rgba(0,255,0,0.1); border: 3px solid var(--lime);">
        <p style="font-size: 10px; color: var(--lime);">YOUR TEAM:</p>
        <p style="font-size: 18px; color: var(--lime);">{{ state.team()?.name }}</p>
      </div>

      <!-- Create team form (only if no team exists) -->
      <div *ngIf="!state.team()" style="display: grid; gap: 12px;">
        <div class="field">
          <label>TEAM NAME:</label>
          <input [(ngModel)]="teamName" placeholder="MY TEAM" />
        </div>

        <button class="btn primary" style="width: 100%;" (click)="saveTeam()">
          ‚òÖ [ SAVE TEAM ] ‚òÖ
        </button>
      </div>

      <!-- Add member -->
      <div style="margin-top: 16px; padding-top: 16px; border-top: 2px dashed var(--cyan);">
        <h3 style="margin-bottom: 8px;">‚ûï ADD MEMBER</h3>

        <select class="field-input" style="margin-bottom: 8px;" [(ngModel)]="addUserId">
          <option value="">[ SELECT EMPLOYEE... ]</option>
          <option *ngFor="let emp of employees" [value]="emp.id">
            {{ emp.fullName }} - {{ emp.email }}
          </option>
        </select>

        <button class="btn" style="border-color: var(--lime); color: var(--lime);" (click)="addMember()">
          + ADD
        </button>
      </div>

      <!-- Members -->
      <div style="margin-top: 16px; padding-top: 16px; border-top: 2px dashed var(--cyan);">
        <h3 style="margin-bottom: 8px;">üìå MEMBERS</h3>

        <div *ngIf="!teamMembers.length" class="empty" style="font-size: 12px;">
          [ NO MEMBERS YET ]
        </div>

        <div *ngFor="let m of teamMembers" style="padding: 8px; border: 2px solid var(--cyan); background: var(--bg); margin-bottom: 8px;">
          <p style="word-break: break-word;">{{ m.fullName }}</p>
          <p style="font-size: 12px; color: var(--ink-soft); word-break: break-word;">{{ m.email }}</p>
        </div>
      </div>
    </div>

    <!-- Create Task Panel -->
    <div class="panel" style="background: linear-gradient(135deg, var(--panel), rgba(0,255,0,0.15)); border-color: var(--lime);">
      <div class="panel-header" style="border-color: var(--lime);">
        <div>
          <h2>‚úèÔ∏è ASSIGN TASK</h2>
          <p class="muted" style="font-size: 12px;">ASSIGN WORK TO YOUR TEAM</p>
        </div>
      </div>

      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
        <div class="field" style="grid-column: span 2;">
          <label>TASK TITLE:</label>
          <input [(ngModel)]="taskTitle" placeholder="TASK TITLE" />
        </div>

        <div class="field" style="grid-column: span 2;">
          <label>ASSIGNEE (TEAM MEMBER):</label>
          <select [(ngModel)]="taskAssigneeId">
            <option value="">[ SELECT... ]</option>
            <option *ngFor="let m of teamMembers" [value]="m.userId">
              {{ m.fullName }} - {{ m.email }}
            </option>
          </select>
        </div>

        <div class="field" style="grid-column: span 2;">
          <label>DESCRIPTION:</label>
          <textarea [(ngModel)]="taskDescription" rows="3" placeholder="ADD CONTEXT..."></textarea>
        </div>

        <div class="field">
          <label>PRIORITY:</label>
          <select [(ngModel)]="taskPriority">
            <option value="LOW">LOW</option>
            <option value="MEDIUM">MEDIUM</option>
            <option value="HIGH">HIGH</option>
          </select>
        </div>

        <div class="field">
          <label>DUE DATE:</label>
          <input type="date" [(ngModel)]="taskDueDate" />
        </div>
      </div>

      <div class="panel-footer" style="border-color: var(--lime);">
        <div style="flex: 1; min-width: 220px;">
          <p *ngIf="localError" class="alert error" style="margin: 0;">
            ‚úó {{ localError }}
          </p>
          <p *ngIf="localMessage" class="alert success" style="margin: 0;">
            ‚úì {{ localMessage }}
          </p>
        </div>

        <button class="btn primary" (click)="createTask()">
          ‚òÖ [ CREATE TASK ] ‚òÖ
        </button>
      </div>
    </div>
  </div>

  <!-- Task List -->
  <div class="panel">
    <div class="panel-header">
      <div>
        <h2>üìã TASKS YOU CREATED</h2>
        <p class="muted" style="font-size: 12px;">MANAGER VIEW</p>
      </div>

      <button class="btn" (click)="state.loadManagerTasks()">
        ‚Üª REFRESH
      </button>
    </div>

    <div *ngIf="!tasks.length" class="empty">
      <p style="font-size: 32px; margin-bottom: 8px;">üìã</p>
      <p>[ NO TASKS YET ]</p>
      <p style="font-size: 12px; margin-top: 4px;">CREATE ONE OR REFRESH!</p>
    </div>

    <div class="task-grid" *ngIf="tasks.length">
      <div *ngFor="let task of tasks" class="task-card">
        <div class="task-head">
          <div style="min-width: 0;">
            <h3 style="word-break: break-word; margin-bottom: 4px;">{{ task.title }}</h3>
            <p style="font-size: 14px; word-break: break-word;">{{ task.description || '[ NO DESCRIPTION ]' }}</p>
          </div>

          <div style="display: flex; flex-direction: column; align-items: flex-end; gap: 4px;">
            <span
              class="badge"
              [style.background]="task.priority==='HIGH' ? 'var(--red)' : task.priority==='MEDIUM' ? 'var(--yellow)' : 'var(--cyan)'"
              [style.color]="'var(--bg)'"
              [style.border-color]="'var(--bg)'"
            >
              {{ task.priority }}
            </span>
            <span style="font-size: 12px; color: var(--yellow);">DUE: {{ task.dueDate || 'NONE' }}</span>
          </div>
        </div>

        <div style="display: flex; align-items: center; gap: 8px;">
          <span
            class="badge"
            [style.background]="task.status==='COMPLETED' ? 'var(--lime)' : task.status==='PENDING' ? 'var(--orange)' : 'var(--cyan)'"
            [style.color]="'var(--bg)'"
            [style.border-color]="'var(--bg)'"
          >
            {{ task.status }}
          </span>
        </div>

        <div style="font-size: 12px; background: var(--bg); border: 2px solid var(--cyan); padding: 8px;">
          <p style="word-break: break-word;">‚Üí CREATED BY: {{ task.createdByName || 'UNKNOWN' }}</p>
          <p style="word-break: break-word;">‚Üí ASSIGNED TO: {{ task.assignedToName || 'UNKNOWN' }}</p>
        </div>
      </div>
    </div>
  </div>
</div>
