<div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
  <!-- Create Task Panel -->
  <div class="lg:col-span-1 panel" style="background: linear-gradient(135deg, var(--panel), rgba(0,255,0,0.15)); border-color: var(--lime);">
    <div class="panel-header" style="border-color: var(--lime);">
      <div>
        <h2>‚úèÔ∏è CREATE TASK</h2>
        <p class="muted" style="font-size: 12px;">ASSIGN TO EMPLOYEE / TEAM LEAD</p>
      </div>

      <button class="btn" (click)="state.loadManagerTasks()">
        ‚Üª REFRESH
      </button>
    </div>

    <div style="display: grid; gap: 12px;">
      <div class="field">
        <label>TITLE:</label>
        <input [(ngModel)]="taskTitle" placeholder="TASK TITLE" />
      </div>

      <div class="field">
        <label>ASSIGNEE (EMPLOYEE OR TEAM LEAD):</label>
        <select [(ngModel)]="taskAssigneeId">
          <option value="">[ SELECT... ]</option>
          <option *ngFor="let emp of employees" [value]="emp.id">
            {{ emp.fullName }} - {{ emp.email }}
          </option>
        </select>
      </div>

      <div class="field">
        <label>DESCRIPTION:</label>
        <textarea [(ngModel)]="taskDescription" rows="3" placeholder="ADD CONTEXT..."></textarea>
      </div>

      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
        <div class="field">
          <label>PRIORITY:</label>
          <select [(ngModel)]="taskPriority">
            <option value="LOW">LOW</option>
            <option value="MEDIUM">MEDIUM</option>
            <option value="HIGH">HIGH</option>
          </select>
        </div>

        <div class="field">
          <label>DUE DATE:</label>
          <input type="date" [(ngModel)]="taskDueDate" />
        </div>
      </div>
    </div>

    <div class="panel-footer" style="border-color: var(--lime);">
      <div style="flex: 1; min-width: 220px;">
        <p *ngIf="localError" class="alert error" style="margin: 0;">
          ‚úó {{ localError }}
        </p>
        <p *ngIf="localMessage" class="alert success" style="margin: 0;">
          ‚úì {{ localMessage }}
        </p>
      </div>

      <button class="btn primary" (click)="createTask()">
        ‚òÖ [ CREATE ] ‚òÖ
      </button>
    </div>
  </div>

  <!-- Task Board -->
  <div class="lg:col-span-2 panel">
    <div class="panel-header">
      <div>
        <h2>üìä TASK BOARD</h2>
        <p class="muted" style="font-size: 12px;">ALL CREATED TASKS</p>
      </div>

      <button class="btn" (click)="state.loadManagerTasks()">
        ‚Üª REFRESH
      </button>
    </div>

    <!-- Empty -->
    <div *ngIf="!tasks.length" class="empty">
      <p style="font-size: 32px; margin-bottom: 8px;">üìã</p>
      <p>[ NO TASKS YET ]</p>
      <p style="font-size: 12px; margin-top: 4px;">CREATE ONE OR REFRESH!</p>
    </div>

    <!-- Grid -->
    <div class="task-grid" *ngIf="tasks.length">
      <div *ngFor="let task of tasks" class="task-card">
        <!-- Header -->
        <div class="task-head">
          <div style="min-width: 0;">
            <h3 style="word-break: break-word; margin-bottom: 4px;">{{ task.title }}</h3>
            <p style="font-size: 14px; word-break: break-word;">{{ task.description || '[ NO DESCRIPTION ]' }}</p>
          </div>

          <div style="display: flex; flex-direction: column; align-items: flex-end; gap: 4px;">
            <span
              class="badge"
              [style.background]="task.priority==='HIGH' ? 'var(--red)' : task.priority==='MEDIUM' ? 'var(--yellow)' : 'var(--cyan)'"
              [style.color]="'var(--bg)'"
              [style.border-color]="'var(--bg)'"
            >
              {{ task.priority }}
            </span>
            <span style="font-size: 12px; color: var(--yellow);">DUE: {{ task.dueDate || 'NONE' }}</span>
          </div>
        </div>

        <!-- Status -->
        <div style="display: flex; align-items: center; gap: 8px;">
          <span
            class="badge"
            [style.background]="task.status==='COMPLETED' ? 'var(--lime)' : task.status==='PENDING' ? 'var(--orange)' : 'var(--cyan)'"
            [style.color]="'var(--bg)'"
            [style.border-color]="'var(--bg)'"
          >
            {{ task.status }}
          </span>
        </div>

        <!-- Meta -->
        <div style="font-size: 12px; background: var(--bg); border: 2px solid var(--cyan); padding: 8px;">
          <p style="word-break: break-word;">‚Üí CREATED BY: {{ task.createdByName || 'UNKNOWN' }}</p>
          <p style="word-break: break-word;">‚Üí ASSIGNED TO: {{ task.assignedToName || 'UNKNOWN' }}</p>
        </div>
      </div>
    </div>
  </div>
</div>
